Kucheka = angular.module('Kucheka', ['ngResource'])

Kucheka.controller "KuchekaCtrl", KuchekaCtrl = ($scope, $http, $resource, $routeParams, $location) ->

  $scope.isActive = (route) ->
    route is $location.path()

Kucheka.controller "KuchekaUserCtrl", KuchekaUserCtrl = ($scope, $http, $resource, $routeParams, $location) ->
  $scope.slug = $routeParams.slug

  User = $resource("/api/users/:id",
    id: "@id"
  ,
    update:
      method: 'PUT'
    index:
      method: 'GET'
      isArray:true
  )

  user = User.get(
    id: 1
  , ->
    #user.abc = true
    #user.$update()
  )

  $scope.name = user.name
  $scope.bio = "Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor. Donec id elit non mi porta gravida at eget metus."

Kucheka.config ($routeProvider, $locationProvider) ->
    $locationProvider.html5Mode(true)
    $routeProvider.when("/",
        templateUrl: "<%= asset_path 'angular/partials/home.tpl.html' %>"
        controller: "KuchekaCtrl"
    ).when("/about",
        templateUrl: "<%= asset_path 'angular/partials/about.tpl.html' %>"
    ).when("/:slug",
        templateUrl: "<%= asset_path 'angular/partials/profile.tpl.html' %>"
        controller: "KuchekaUserCtrl"
    ).otherwise redirectTo: "/"



